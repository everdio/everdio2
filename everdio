#!/usr/bin/env php
<?php
\ini_set("memory_limit", "2048M");
\date_default_timezone_set("Europe/Amsterdam");
\setlocale(\LC_TIME, "nl_NL.utf8");
\ini_set('intl.default_locale', 'nl-NL');
\ini_set('display_errors', '1'); 

include_once(__DIR__ . \DIRECTORY_SEPARATOR . "everdio.php");

$controller = new \Component\Core\Controller\Model\Cli;
$controller->server = $_SERVER;
$controller->debug = "_debug";
$controller->path = __DIR__;        
$controller->pool = __DIR__ . \DIRECTORY_SEPARATOR . "threads";

try {
    $controller->setup();
    echo $controller->execute(\DIRECTORY_SEPARATOR . $controller->arguments);
} catch (\Exception $ex) {
    echo \PHP_EOL . \ucfirst($ex->getMessage()) . \PHP_EOL . \PHP_EOL;
    if (isset($controller->request->{$controller->debug})) {
        echo $ex->getTraceAsString() . \PHP_EOL;
        if ($ex->getPrevious()) {
            echo $ex->getPrevious()->getMessage() . \PHP_EOL;
            echo $ex->getPrevious()->getTraceAsString() . \PHP_EOL . \PHP_EOL;
        }
    }
}

exit;