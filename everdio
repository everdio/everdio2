#!/usr/bin/env php
<?php
ini_set("memory_limit", "1536M");
include_once(__DIR__ . DIRECTORY_SEPARATOR . "everdio.php");

$cli = new \Component\Core\Controller\Model\Cli;
$cli->server = $_SERVER;
$cli->parser = new \Component\Parser\Ini;
$cli->setup();
echo "\neverdio 2.0 ~ command line interface\n\n";
\flush();

try {
    echo $cli->execute(__DIR__ . \DIRECTORY_SEPARATOR . $cli->route) . PHP_EOL;
    \flush();
} catch (\Exception | \ErrorException $ex) {
    echo \sprintf("\n%s: %s\n", get_class($ex), $ex->getMessage());
    \flush();
    if (isset($cli->request->debug)) {
        echo \sprintf("\n%s\n", $ex->getTraceAsString());
        \flush();
    }
}
exit;