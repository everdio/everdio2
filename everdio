#!/usr/bin/env php
<?php
ini_set("memory_limit", "1536M");
include_once(__DIR__ . DIRECTORY_SEPARATOR . "everdio.php");

$cli = new \Component\Core\Controller\Model\Cli;
$cli->server = $_SERVER;
$cli->parser = new \Component\Parser\Ini;
$cli->setup();

fwrite(STDOUT, "\neverdio 2.0 ~ command line interface\n\n");

try {
    fwrite(STDOUT, $cli->execute(__DIR__ . \DIRECTORY_SEPARATOR . $cli->route) . PHP_EOL);
} catch (\Exception | \ErrorException $ex) {
    fwrite(STDERR, \sprintf("\n%s: %s\n\n", get_class($ex), $ex->getMessage()));    
    if (isset($cli->request->debug)) {
        fwrite(STDERR, \sprintf("\n%s\n\n", $ex->getTraceAsString()));
    }
}
exit;